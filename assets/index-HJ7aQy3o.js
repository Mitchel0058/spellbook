var _o=Object.defineProperty;var fo=(t,e,n)=>e in t?_o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Q=(t,e,n)=>fo(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var Se,O,_n,_e,At,fn,dn,hn,ut,et,tt,pn,Le={},mn=[],ho=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ie=Array.isArray;function oe(t,e){for(var n in e)t[n]=e[n];return t}function _t(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function W(t,e,n){var o,r,i,a={};for(i in e)i=="key"?o=e[i]:i=="ref"?r=e[i]:a[i]=e[i];if(arguments.length>2&&(a.children=arguments.length>3?Se.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(i in t.defaultProps)a[i]===void 0&&(a[i]=t.defaultProps[i]);return we(t,a,o,r,null)}function we(t,e,n,o,r){var i={type:t,props:e,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++_n,__i:-1,__u:0};return r==null&&O.vnode!=null&&O.vnode(i),i}function En(){return{current:null}}function $(t){return t.children}function te(t,e){this.props=t,this.context=e}function me(t,e){if(e==null)return t.__?me(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?me(t):null}function gn(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return gn(t)}}function nt(t){(!t.__d&&(t.__d=!0)&&_e.push(t)&&!Fe.__r++||At!=O.debounceRendering)&&((At=O.debounceRendering)||fn)(Fe)}function Fe(){for(var t,e,n,o,r,i,a,u=1;_e.length;)_e.length>u&&_e.sort(dn),t=_e.shift(),u=_e.length,t.__d&&(n=void 0,o=void 0,r=(o=(e=t).__v).__e,i=[],a=[],e.__P&&((n=oe({},o)).__v=o.__v+1,O.vnode&&O.vnode(n),ft(e.__P,n,o,e.__n,e.__P.namespaceURI,32&o.__u?[r]:null,i,r??me(o),!!(32&o.__u),a),n.__v=o.__v,n.__.__k[n.__i]=n,bn(i,n,a),o.__e=o.__=null,n.__e!=r&&gn(n)));Fe.__r=0}function yn(t,e,n,o,r,i,a,u,f,l,p){var c,m,E,S,T,w,I,R=o&&o.__k||mn,G=e.length;for(f=po(n,e,R,f,G),c=0;c<G;c++)(E=n.__k[c])!=null&&(m=E.__i==-1?Le:R[E.__i]||Le,E.__i=c,w=ft(t,E,m,r,i,a,u,f,l,p),S=E.__e,E.ref&&m.ref!=E.ref&&(m.ref&&dt(m.ref,null,E),p.push(E.ref,E.__c||S,E)),T==null&&S!=null&&(T=S),(I=!!(4&E.__u))||m.__k===E.__k?f=vn(E,f,t,I):typeof E.type=="function"&&w!==void 0?f=w:S&&(f=S.nextSibling),E.__u&=-7);return n.__e=T,f}function po(t,e,n,o,r){var i,a,u,f,l,p=n.length,c=p,m=0;for(t.__k=new Array(r),i=0;i<r;i++)(a=e[i])!=null&&typeof a!="boolean"&&typeof a!="function"?(f=i+m,(a=t.__k[i]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?we(null,a,null,null,null):Ie(a)?we($,{children:a},null,null,null):a.constructor==null&&a.__b>0?we(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=t,a.__b=t.__b+1,u=null,(l=a.__i=mo(a,n,f,c))!=-1&&(c--,(u=n[l])&&(u.__u|=2)),u==null||u.__v==null?(l==-1&&(r>p?m--:r<p&&m++),typeof a.type!="function"&&(a.__u|=4)):l!=f&&(l==f-1?m--:l==f+1?m++:(l>f?m--:m++,a.__u|=4))):t.__k[i]=null;if(c)for(i=0;i<p;i++)(u=n[i])!=null&&(2&u.__u)==0&&(u.__e==o&&(o=me(u)),On(u,u));return o}function vn(t,e,n,o){var r,i;if(typeof t.type=="function"){for(r=t.__k,i=0;r&&i<r.length;i++)r[i]&&(r[i].__=t,e=vn(r[i],e,n,o));return e}t.__e!=e&&(o&&(e&&t.type&&!e.parentNode&&(e=me(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function ie(t,e){return e=e||[],t==null||typeof t=="boolean"||(Ie(t)?t.some(function(n){ie(n,e)}):e.push(t)),e}function mo(t,e,n,o){var r,i,a,u=t.key,f=t.type,l=e[n],p=l!=null&&(2&l.__u)==0;if(l===null&&t.key==null||p&&u==l.key&&f==l.type)return n;if(o>(p?1:0)){for(r=n-1,i=n+1;r>=0||i<e.length;)if((l=e[a=r>=0?r--:i++])!=null&&(2&l.__u)==0&&u==l.key&&f==l.type)return a}return-1}function Pt(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||ho.test(e)?n:n+"px"}function Pe(t,e,n,o,r){var i,a;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e in o)n&&e in n||Pt(t.style,e,"");if(n)for(e in n)o&&n[e]==o[e]||Pt(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")i=e!=(e=e.replace(hn,"$1")),a=e.toLowerCase(),e=a in t||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+i]=n,n?o?n.u=o.u:(n.u=ut,t.addEventListener(e,i?tt:et,i)):t.removeEventListener(e,i?tt:et,i);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Dt(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ut++;else if(e.t<n.u)return;return n(O.event?O.event(e):e)}}}function ft(t,e,n,o,r,i,a,u,f,l){var p,c,m,E,S,T,w,I,R,G,x,ne,ce,Ue,J,M,X,j=e.type;if(e.constructor!=null)return null;128&n.__u&&(f=!!(32&n.__u),i=[u=e.__e=n.__e]),(p=O.__b)&&p(e);e:if(typeof j=="function")try{if(I=e.props,R="prototype"in j&&j.prototype.render,G=(p=j.contextType)&&o[p.__c],x=p?G?G.props.value:p.__:o,n.__c?w=(c=e.__c=n.__c).__=c.__E:(R?e.__c=c=new j(I,x):(e.__c=c=new te(I,x),c.constructor=j,c.render=go),G&&G.sub(c),c.props=I,c.state||(c.state={}),c.context=x,c.__n=o,m=c.__d=!0,c.__h=[],c._sb=[]),R&&c.__s==null&&(c.__s=c.state),R&&j.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=oe({},c.__s)),oe(c.__s,j.getDerivedStateFromProps(I,c.__s))),E=c.props,S=c.state,c.__v=e,m)R&&j.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),R&&c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(R&&j.getDerivedStateFromProps==null&&I!==E&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(I,x),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(I,c.__s,x)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(c.props=I,c.state=c.__s,c.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(Y){Y&&(Y.__=e)}),ne=0;ne<c._sb.length;ne++)c.__h.push(c._sb[ne]);c._sb=[],c.__h.length&&a.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(I,c.__s,x),R&&c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(E,S,T)})}if(c.context=x,c.props=I,c.__P=t,c.__e=!1,ce=O.__r,Ue=0,R){for(c.state=c.__s,c.__d=!1,ce&&ce(e),p=c.render(c.props,c.state,c.context),J=0;J<c._sb.length;J++)c.__h.push(c._sb[J]);c._sb=[]}else do c.__d=!1,ce&&ce(e),p=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++Ue<25);c.state=c.__s,c.getChildContext!=null&&(o=oe(oe({},o),c.getChildContext())),R&&!m&&c.getSnapshotBeforeUpdate!=null&&(T=c.getSnapshotBeforeUpdate(E,S)),M=p,p!=null&&p.type===$&&p.key==null&&(M=Nn(p.props.children)),u=yn(t,Ie(M)?M:[M],e,n,o,r,i,a,u,f,l),c.base=e.__e,e.__u&=-161,c.__h.length&&a.push(c),w&&(c.__E=c.__=null)}catch(Y){if(e.__v=null,f||i!=null)if(Y.then){for(e.__u|=f?160:128;u&&u.nodeType==8&&u.nextSibling;)u=u.nextSibling;i[i.indexOf(u)]=null,e.__e=u}else{for(X=i.length;X--;)_t(i[X]);ot(e)}else e.__e=n.__e,e.__k=n.__k,Y.then||ot(e);O.__e(Y,e,n)}else i==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):u=e.__e=Eo(n.__e,e,n,o,r,i,a,f,l);return(p=O.diffed)&&p(e),128&e.__u?void 0:u}function ot(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ot)}function bn(t,e,n){for(var o=0;o<n.length;o++)dt(n[o],n[++o],n[++o]);O.__c&&O.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(i){i.call(r)})}catch(i){O.__e(i,r.__v)}})}function Nn(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:Ie(t)?t.map(Nn):oe({},t)}function Eo(t,e,n,o,r,i,a,u,f){var l,p,c,m,E,S,T,w=n.props,I=e.props,R=e.type;if(R=="svg"?r="http://www.w3.org/2000/svg":R=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),i!=null){for(l=0;l<i.length;l++)if((E=i[l])&&"setAttribute"in E==!!R&&(R?E.localName==R:E.nodeType==3)){t=E,i[l]=null;break}}if(t==null){if(R==null)return document.createTextNode(I);t=document.createElementNS(r,R,I.is&&I),u&&(O.__m&&O.__m(e,i),u=!1),i=null}if(R==null)w===I||u&&t.data==I||(t.data=I);else{if(i=i&&Se.call(t.childNodes),w=n.props||Le,!u&&i!=null)for(w={},l=0;l<t.attributes.length;l++)w[(E=t.attributes[l]).name]=E.value;for(l in w)if(E=w[l],l!="children"){if(l=="dangerouslySetInnerHTML")c=E;else if(!(l in I)){if(l=="value"&&"defaultValue"in I||l=="checked"&&"defaultChecked"in I)continue;Pe(t,l,null,E,r)}}for(l in I)E=I[l],l=="children"?m=E:l=="dangerouslySetInnerHTML"?p=E:l=="value"?S=E:l=="checked"?T=E:u&&typeof E!="function"||w[l]===E||Pe(t,l,E,w[l],r);if(p)u||c&&(p.__html==c.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(c&&(t.innerHTML=""),yn(e.type=="template"?t.content:t,Ie(m)?m:[m],e,n,o,R=="foreignObject"?"http://www.w3.org/1999/xhtml":r,i,a,i?i[0]:n.__k&&me(n,0),u,f),i!=null)for(l=i.length;l--;)_t(i[l]);u||(l="value",R=="progress"&&S==null?t.removeAttribute("value"):S!=null&&(S!==t[l]||R=="progress"&&!S||R=="option"&&S!=w[l])&&Pe(t,l,S,w[l],r),l="checked",T!=null&&T!=t[l]&&Pe(t,l,T,w[l],r))}return t}function dt(t,e,n){try{if(typeof t=="function"){var o=typeof t.__u=="function";o&&t.__u(),o&&e==null||(t.__u=t(e))}else t.current=e}catch(r){O.__e(r,n)}}function On(t,e,n){var o,r;if(O.unmount&&O.unmount(t),(o=t.ref)&&(o.current&&o.current!=t.__e||dt(o,null,e)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(i){O.__e(i,e)}o.base=o.__P=null}if(o=t.__k)for(r=0;r<o.length;r++)o[r]&&On(o[r],e,n||typeof t.type!="function");n||_t(t.__e),t.__c=t.__=t.__e=void 0}function go(t,e,n){return this.constructor(t,n)}function Ee(t,e,n){var o,r,i,a;e==document&&(e=document.documentElement),O.__&&O.__(t,e),r=(o=typeof n=="function")?null:n&&n.__k||e.__k,i=[],a=[],ft(e,t=(!o&&n||e).__k=W($,null,[t]),r||Le,Le,e.namespaceURI,!o&&n?[n]:r?null:e.firstChild?Se.call(e.childNodes):null,i,!o&&n?n:r?r.__e:e.firstChild,o,a),bn(i,t,a)}function wn(t,e){Ee(t,e,wn)}function yo(t,e,n){var o,r,i,a,u=oe({},t.props);for(i in t.type&&t.type.defaultProps&&(a=t.type.defaultProps),e)i=="key"?o=e[i]:i=="ref"?r=e[i]:u[i]=e[i]===void 0&&a!=null?a[i]:e[i];return arguments.length>2&&(u.children=arguments.length>3?Se.call(arguments,2):n),we(t.type,u,o||t.key,r||t.ref,null)}function Te(t){function e(n){var o,r;return this.getChildContext||(o=new Set,(r={})[e.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){o=null},this.shouldComponentUpdate=function(i){this.props.value!=i.value&&o.forEach(function(a){a.__e=!0,nt(a)})},this.sub=function(i){o.add(i);var a=i.componentWillUnmount;i.componentWillUnmount=function(){o&&o.delete(i),a&&a.call(i)}}),n.children}return e.__c="__cC"+pn++,e.__=t,e.Provider=e.__l=(e.Consumer=function(n,o){return n.children(o)}).contextType=e,e}Se=mn.slice,O={__e:function(t,e,n,o){for(var r,i,a;e=e.__;)if((r=e.__c)&&!r.__)try{if((i=r.constructor)&&i.getDerivedStateFromError!=null&&(r.setState(i.getDerivedStateFromError(t)),a=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,o||{}),a=r.__d),a)return r.__E=r}catch(u){t=u}throw t}},_n=0,te.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=oe({},this.state),typeof t=="function"&&(t=t(oe({},n),this.props)),t&&oe(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),nt(this))},te.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),nt(this))},te.prototype.render=$,_e=[],fn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,dn=function(t,e){return t.__v.__b-e.__v.__b},Fe.__r=0,hn=/(PointerCapture)$|Capture$/i,ut=0,et=Dt(!1),tt=Dt(!0),pn=0;var vo=0;function _(t,e,n,o,r,i){e||(e={});var a,u,f=e;if("ref"in f)for(u in f={},e)u=="ref"?a=e[u]:f[u]=e[u];var l={type:t,props:f,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--vo,__i:-1,__u:0,__source:r,__self:i};if(typeof t=="function"&&(a=t.defaultProps))for(u in a)f[u]===void 0&&(f[u]=a[u]);return O.vnode&&O.vnode(l),l}function bo(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,o,r,i,a=[],u="",f=t.split("/");for(f[0]||f.shift();r=f.shift();)n=r[0],n==="*"?(a.push(n),u+=r[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(o=r.indexOf("?",1),i=r.indexOf(".",1),a.push(r.substring(1,~o?o:~i?i:r.length)),u+=~o&&!~i?"(?:/([^/]+?))?":"/([^/]+?)",~i&&(u+=(~o?"?":"")+"\\"+r.substring(i))):u+="/"+r;return{keys:a,pattern:new RegExp("^"+u+(e?"(?=$|/)":"/?$"),"i")}}var ae,k,We,Ft,ge=0,Cn=[],D=O,jt=D.__b,Bt=D.__r,$t=D.diffed,xt=D.__c,Mt=D.unmount,Gt=D.__;function fe(t,e){D.__h&&D.__h(k,t,ge||e),ge=0;var n=k.__H||(k.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function C(t){return ge=1,Be(Ln,t)}function Be(t,e,n){var o=fe(ae++,2);if(o.t=t,!o.__c&&(o.__=[n?n(e):Ln(void 0,e),function(u){var f=o.__N?o.__N[0]:o.__[0],l=o.t(f,u);f!==l&&(o.__N=[l,o.__[1]],o.__c.setState({}))}],o.__c=k,!k.__f)){var r=function(u,f,l){if(!o.__c.__H)return!0;var p=o.__c.__H.__.filter(function(m){return!!m.__c});if(p.every(function(m){return!m.__N}))return!i||i.call(this,u,f,l);var c=o.__c.props!==u;return p.forEach(function(m){if(m.__N){var E=m.__[0];m.__=m.__N,m.__N=void 0,E!==m.__[0]&&(c=!0)}}),i&&i.call(this,u,f,l)||c};k.__f=!0;var i=k.shouldComponentUpdate,a=k.componentWillUpdate;k.componentWillUpdate=function(u,f,l){if(this.__e){var p=i;i=void 0,r(u,f,l),i=p}a&&a.call(this,u,f,l)},k.shouldComponentUpdate=r}return o.__N||o.__}function F(t,e){var n=fe(ae++,3);!D.__s&&Et(n.__H,e)&&(n.__=t,n.u=e,k.__H.__h.push(n))}function de(t,e){var n=fe(ae++,4);!D.__s&&Et(n.__H,e)&&(n.__=t,n.u=e,k.__h.push(n))}function re(t){return ge=5,Re(function(){return{current:t}},[])}function ht(t,e,n){ge=6,de(function(){if(typeof t=="function"){var o=t(e());return function(){t(null),o&&typeof o=="function"&&o()}}if(t)return t.current=e(),function(){return t.current=null}},n==null?n:n.concat(t))}function Re(t,e){var n=fe(ae++,7);return Et(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function $e(t,e){return ge=8,Re(function(){return t},e)}function ve(t){var e=k.context[t.__c],n=fe(ae++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(k)),e.props.value):t.__}function pt(t,e){D.useDebugValue&&D.useDebugValue(e?e(t):t)}function No(t){var e=fe(ae++,10),n=C();return e.__=t,k.componentDidCatch||(k.componentDidCatch=function(o,r){e.__&&e.__(o,r),n[1](o)}),[n[0],function(){n[1](void 0)}]}function mt(){var t=fe(ae++,11);if(!t.__){for(var e=k.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var n=e.__m||(e.__m=[0,0]);t.__="P"+n[0]+"-"+n[1]++}return t.__}function Oo(){for(var t;t=Cn.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(De),t.__H.__h.forEach(rt),t.__H.__h=[]}catch(e){t.__H.__h=[],D.__e(e,t.__v)}}D.__b=function(t){k=null,jt&&jt(t)},D.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Gt&&Gt(t,e)},D.__r=function(t){Bt&&Bt(t),ae=0;var e=(k=t.__c).__H;e&&(We===k?(e.__h=[],k.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(De),e.__h.forEach(rt),e.__h=[],ae=0)),We=k},D.diffed=function(t){$t&&$t(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Cn.push(e)!==1&&Ft===D.requestAnimationFrame||((Ft=D.requestAnimationFrame)||wo)(Oo)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),We=k=null},D.__c=function(t,e){e.some(function(n){try{n.__h.forEach(De),n.__h=n.__h.filter(function(o){return!o.__||rt(o)})}catch(o){e.some(function(r){r.__h&&(r.__h=[])}),e=[],D.__e(o,n.__v)}}),xt&&xt(t,e)},D.unmount=function(t){Mt&&Mt(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{De(o)}catch(r){e=r}}),n.__H=void 0,e&&D.__e(e,n.__v))};var Vt=typeof requestAnimationFrame=="function";function wo(t){var e,n=function(){clearTimeout(o),Vt&&cancelAnimationFrame(e),setTimeout(t)},o=setTimeout(n,35);Vt&&(e=requestAnimationFrame(n))}function De(t){var e=k,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),k=e}function rt(t){var e=k;t.__c=t.__(),k=e}function Et(t,e){return!t||t.length!==e.length||e.some(function(n,o){return n!==t[o]})}function Ln(t,e){return typeof e=="function"?e(t):e}function Sn(t,e){for(var n in e)t[n]=e[n];return t}function st(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var o in e)if(o!=="__source"&&t[o]!==e[o])return!0;return!1}function gt(t,e){var n=e(),o=C({t:{__:n,u:e}}),r=o[0].t,i=o[1];return de(function(){r.__=n,r.u=e,Je(r)&&i({t:r})},[t,n,e]),F(function(){return Je(r)&&i({t:r}),t(function(){Je(r)&&i({t:r})})},[t]),n}function Je(t){var e,n,o=t.u,r=t.__;try{var i=o();return!((e=r)===(n=i)&&(e!==0||1/e==1/n)||e!=e&&n!=n)}catch{return!0}}function yt(t){t()}function vt(t){return t}function bt(){return[!1,yt]}var Nt=de;function je(t,e){this.props=t,this.context=e}function In(t,e){function n(r){var i=this.props.ref,a=i==r.ref;return!a&&i&&(i.call?i(null):i.current=null),e?!e(this.props,r)||!a:st(this.props,r)}function o(r){return this.shouldComponentUpdate=n,W(t,r)}return o.displayName="Memo("+(t.displayName||t.name)+")",o.prototype.isReactComponent=!0,o.__f=!0,o.type=t,o}(je.prototype=new te).isPureReactComponent=!0,je.prototype.shouldComponentUpdate=function(t,e){return st(this.props,t)||st(this.state,e)};var Ht=O.__b;O.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),Ht&&Ht(t)};var Co=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Ot(t){function e(n){var o=Sn({},n);return delete o.ref,t(o,n.ref||null)}return e.$$typeof=Co,e.render=t,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(t.displayName||t.name)+")",e}var Kt=function(t,e){return t==null?null:ie(ie(t).map(e))},Tn={map:Kt,forEach:Kt,count:function(t){return t?ie(t).length:0},only:function(t){var e=ie(t);if(e.length!==1)throw"Children.only";return e[0]},toArray:ie},Lo=O.__e;O.__e=function(t,e,n,o){if(t.then){for(var r,i=e;i=i.__;)if((r=i.__c)&&r.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),r.__c(t,e)}Lo(t,e,n,o)};var Wt=O.unmount;function Rn(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(o){typeof o.__c=="function"&&o.__c()}),t.__c.__H=null),(t=Sn({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c.__e=!0,t.__c=null),t.__k=t.__k&&t.__k.map(function(o){return Rn(o,e,n)})),t}function Un(t,e,n){return t&&n&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(o){return Un(o,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.appendChild(t.__e),t.__c.__e=!0,t.__c.__P=n)),t}function Ce(){this.__u=0,this.o=null,this.__b=null}function kn(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function An(t){var e,n,o;function r(i){if(e||(e=t()).then(function(a){n=a.default||a},function(a){o=a}),o)throw o;if(!n)throw e;return W(n,i)}return r.displayName="Lazy",r.__f=!0,r}function pe(){this.i=null,this.l=null}O.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&32&t.__u&&(t.type=null),Wt&&Wt(t)},(Ce.prototype=new te).__c=function(t,e){var n=e.__c,o=this;o.o==null&&(o.o=[]),o.o.push(n);var r=kn(o.__v),i=!1,a=function(){i||(i=!0,n.__R=null,r?r(u):u())};n.__R=a;var u=function(){if(!--o.__u){if(o.state.__a){var f=o.state.__a;o.__v.__k[0]=Un(f,f.__c.__P,f.__c.__O)}var l;for(o.setState({__a:o.__b=null});l=o.o.pop();)l.forceUpdate()}};o.__u++||32&e.__u||o.setState({__a:o.__b=o.__v.__k[0]}),t.then(a,a)},Ce.prototype.componentWillUnmount=function(){this.o=[]},Ce.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),o=this.__v.__k[0].__c;this.__v.__k[0]=Rn(this.__b,n,o.__O=o.__P)}this.__b=null}var r=e.__a&&W($,null,t.fallback);return r&&(r.__u&=-33),[W($,null,e.__a?null:t.children),r]};var Jt=function(t,e,n){if(++n[1]===n[0]&&t.l.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.l.size))for(n=t.i;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.i=n=n[2]}};function So(t){return this.getChildContext=function(){return t.context},t.children}function Io(t){var e=this,n=t.h;if(e.componentWillUnmount=function(){Ee(null,e.v),e.v=null,e.h=null},e.h&&e.h!==n&&e.componentWillUnmount(),!e.v){for(var o=e.__v;o!==null&&!o.__m&&o.__!==null;)o=o.__;e.h=n,e.v={nodeType:1,parentNode:n,childNodes:[],__k:{__m:o.__m},contains:function(){return!0},insertBefore:function(r,i){this.childNodes.push(r),e.h.insertBefore(r,i)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),e.h.removeChild(r)}}}Ee(W(So,{context:e.context},t.__v),e.v)}function Pn(t,e){var n=W(Io,{__v:t,h:e});return n.containerInfo=e,n}(pe.prototype=new te).__a=function(t){var e=this,n=kn(e.__v),o=e.l.get(t);return o[0]++,function(r){var i=function(){e.props.revealOrder?(o.push(r),Jt(e,t,o)):r()};n?n(i):i()}},pe.prototype.render=function(t){this.i=null,this.l=new Map;var e=ie(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.l.set(e[n],this.i=[1,0,this.i]);return t.children},pe.prototype.componentDidUpdate=pe.prototype.componentDidMount=function(){var t=this;this.l.forEach(function(e,n){Jt(t,n,e)})};var Dn=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,To=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Ro=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Uo=/[A-Z0-9]/g,ko=typeof document<"u",Ao=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(t)};function Fn(t,e,n){return e.__k==null&&(e.textContent=""),Ee(t,e),typeof n=="function"&&n(),t?t.__c:null}function jn(t,e,n){return wn(t,e),typeof n=="function"&&n(),t?t.__c:null}te.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(te.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var zt=O.event;function Po(){}function Do(){return this.cancelBubble}function Fo(){return this.defaultPrevented}O.event=function(t){return zt&&(t=zt(t)),t.persist=Po,t.isPropagationStopped=Do,t.isDefaultPrevented=Fo,t.nativeEvent=t};var wt,jo={enumerable:!1,configurable:!0,get:function(){return this.class}},Yt=O.vnode;O.vnode=function(t){typeof t.type=="string"&&(function(e){var n=e.props,o=e.type,r={},i=o.indexOf("-")===-1;for(var a in n){var u=n[a];if(!(a==="value"&&"defaultValue"in n&&u==null||ko&&a==="children"&&o==="noscript"||a==="class"||a==="className")){var f=a.toLowerCase();a==="defaultValue"&&"value"in n&&n.value==null?a="value":a==="download"&&u===!0?u="":f==="translate"&&u==="no"?u=!1:f[0]==="o"&&f[1]==="n"?f==="ondoubleclick"?a="ondblclick":f!=="onchange"||o!=="input"&&o!=="textarea"||Ao(n.type)?f==="onfocus"?a="onfocusin":f==="onblur"?a="onfocusout":Ro.test(a)&&(a=f):f=a="oninput":i&&To.test(a)?a=a.replace(Uo,"-$&").toLowerCase():u===null&&(u=void 0),f==="oninput"&&r[a=f]&&(a="oninputCapture"),r[a]=u}}o=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=ie(n.children).forEach(function(l){l.props.selected=r.value.indexOf(l.props.value)!=-1})),o=="select"&&r.defaultValue!=null&&(r.value=ie(n.children).forEach(function(l){l.props.selected=r.multiple?r.defaultValue.indexOf(l.props.value)!=-1:r.defaultValue==l.props.value})),n.class&&!n.className?(r.class=n.class,Object.defineProperty(r,"className",jo)):(n.className&&!n.class||n.class&&n.className)&&(r.class=r.className=n.className),e.props=r})(t),t.$$typeof=Dn,Yt&&Yt(t)};var qt=O.__r;O.__r=function(t){qt&&qt(t),wt=t.__c};var Xt=O.diffed;O.diffed=function(t){Xt&&Xt(t);var e=t.props,n=t.__e;n!=null&&t.type==="textarea"&&"value"in e&&e.value!==n.value&&(n.value=e.value==null?"":e.value),wt=null};var Bn={ReactCurrentDispatcher:{current:{readContext:function(t){return wt.__n[t.__c].props.value},useCallback:$e,useContext:ve,useDebugValue:pt,useDeferredValue:vt,useEffect:F,useId:mt,useImperativeHandle:ht,useInsertionEffect:Nt,useLayoutEffect:de,useMemo:Re,useReducer:Be,useRef:re,useState:C,useSyncExternalStore:gt,useTransition:bt}}},Bo="18.3.1";function $n(t){return W.bind(null,t)}function he(t){return!!t&&t.$$typeof===Dn}function xn(t){return he(t)&&t.type===$}function Mn(t){return!!t&&!!t.displayName&&(typeof t.displayName=="string"||t.displayName instanceof String)&&t.displayName.startsWith("Memo(")}function xe(t){return he(t)?yo.apply(null,arguments):t}function Gn(t){return!!t.__k&&(Ee(null,t),!0)}function Vn(t){return t&&(t.base||t.nodeType===1&&t)||null}var Hn=function(t,e){return t(e)},Kn=function(t,e){return t(e)},Wn=$,Jn=he,$o={useState:C,useId:mt,useReducer:Be,useEffect:F,useLayoutEffect:de,useInsertionEffect:Nt,useTransition:bt,useDeferredValue:vt,useSyncExternalStore:gt,startTransition:yt,useRef:re,useImperativeHandle:ht,useMemo:Re,useCallback:$e,useContext:ve,useDebugValue:pt,version:"18.3.1",Children:Tn,render:Fn,hydrate:jn,unmountComponentAtNode:Gn,createPortal:Pn,createElement:W,createContext:Te,createFactory:$n,cloneElement:xe,createRef:En,Fragment:$,isValidElement:he,isElement:Jn,isFragment:xn,isMemo:Mn,findDOMNode:Vn,Component:te,PureComponent:je,memo:In,forwardRef:Ot,flushSync:Kn,unstable_batchedUpdates:Hn,StrictMode:Wn,Suspense:Ce,SuspenseList:pe,lazy:An,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Bn};const zn=Object.freeze(Object.defineProperty({__proto__:null,Children:Tn,Component:te,Fragment:$,PureComponent:je,StrictMode:Wn,Suspense:Ce,SuspenseList:pe,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Bn,cloneElement:xe,createContext:Te,createElement:W,createFactory:$n,createPortal:Pn,createRef:En,default:$o,findDOMNode:Vn,flushSync:Kn,forwardRef:Ot,hydrate:jn,isElement:Jn,isFragment:xn,isMemo:Mn,isValidElement:he,lazy:An,memo:In,render:Fn,startTransition:yt,unmountComponentAtNode:Gn,unstable_batchedUpdates:Hn,useCallback:$e,useContext:ve,useDebugValue:pt,useDeferredValue:vt,useEffect:F,useErrorBoundary:No,useId:mt,useImperativeHandle:ht,useInsertionEffect:Nt,useLayoutEffect:de,useMemo:Re,useReducer:Be,useRef:re,useState:C,useSyncExternalStore:gt,useTransition:bt,version:Bo},Symbol.toStringTag,{value:"Module"}));function xo(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var r=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,r.get?r:{enumerable:!0,get:function(){return t[o]}})}),n}var ze={exports:{}},Ye={};const Mo=xo(zn);/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zt;function Go(){if(Zt)return Ye;Zt=1;var t=Mo;function e(c,m){return c===m&&(c!==0||1/c===1/m)||c!==c&&m!==m}var n=typeof Object.is=="function"?Object.is:e,o=t.useState,r=t.useEffect,i=t.useLayoutEffect,a=t.useDebugValue;function u(c,m){var E=m(),S=o({inst:{value:E,getSnapshot:m}}),T=S[0].inst,w=S[1];return i(function(){T.value=E,T.getSnapshot=m,f(T)&&w({inst:T})},[c,E,m]),r(function(){return f(T)&&w({inst:T}),c(function(){f(T)&&w({inst:T})})},[c]),a(E),E}function f(c){var m=c.getSnapshot;c=c.value;try{var E=m();return!n(c,E)}catch{return!0}}function l(c,m){return m()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:u;return Ye.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,Ye}var Qt;function Vo(){return Qt||(Qt=1,ze.exports=Go()),ze.exports}var Ho=Vo();const Ko=zn.useInsertionEffect,Wo=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Jo=Wo?de:F,zo=Ko||Jo,Yn=t=>{const e=re([t,(...n)=>e[0](...n)]).current;return zo(()=>{e[0]=t}),e[1]},Yo="popstate",Ct="pushState",Lt="replaceState",qo="hashchange",en=[Yo,Ct,Lt,qo],Xo=t=>{for(const e of en)addEventListener(e,t);return()=>{for(const e of en)removeEventListener(e,t)}},qn=(t,e)=>Ho.useSyncExternalStore(Xo,t,e),Zo=()=>location.search,Qo=({ssrSearch:t=""}={})=>qn(Zo,()=>t),tn=()=>location.pathname,er=({ssrPath:t}={})=>qn(tn,t?()=>t:tn),tr=(t,{replace:e=!1,state:n=null}={})=>history[e?Lt:Ct](n,"",t),nr=(t={})=>[er(t),tr],nn=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[nn]>"u"){for(const t of[Ct,Lt]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),o=new Event(t);return o.arguments=arguments,dispatchEvent(o),n}}Object.defineProperty(window,nn,{value:!0})}const or=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",Xn=(t="")=>t==="/"?"":t,rr=(t,e)=>t[0]==="~"?t.slice(1):Xn(e)+t,sr=(t="",e)=>or(on(Xn(t)),on(e)),on=t=>{try{return decodeURI(t)}catch{return t}},Zn={hook:nr,searchHook:Qo,parser:bo,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},Qn=Te(Zn),Me=()=>ve(Qn),eo={},to=Te(eo),ir=()=>ve(to),St=t=>{const[e,n]=t.hook(t);return[sr(t.base,e),Yn((o,r)=>n(rr(o,t.base),r))]},no=(t,e,n,o)=>{const{pattern:r,keys:i}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",o),a=r.exec(n)||[],[u,...f]=a;return u!==void 0?[!0,(()=>{const l=i!==!1?Object.fromEntries(i.map((c,m)=>[c,f[m]])):a.groups;let p={...f};return l&&Object.assign(p,l),p})(),...o?[u]:[]]:[!1,null]},oo=({children:t,...e})=>{var p,c;const n=Me(),o=e.hook?Zn:n;let r=o;const[i,a]=((p=e.ssrPath)==null?void 0:p.split("?"))??[];a&&(e.ssrSearch=a,e.ssrPath=i),e.hrefs=e.hrefs??((c=e.hook)==null?void 0:c.hrefs);let u=re({}),f=u.current,l=f;for(let m in o){const E=m==="base"?o[m]+(e[m]||""):e[m]||o[m];f===l&&E!==l[m]&&(u.current=l={...l}),l[m]=E,(E!==o[m]||E!==r[m])&&(r=l)}return W(Qn.Provider,{value:r,children:t})},rn=({children:t,component:e},n)=>e?W(e,{params:n}):typeof t=="function"?t(n):t,ar=t=>{let e=re(eo);const n=e.current;return e.current=Object.keys(t).length!==Object.keys(n).length||Object.entries(t).some(([o,r])=>r!==n[o])?t:n},qe=({path:t,nest:e,match:n,...o})=>{const r=Me(),[i]=St(r),[a,u,f]=n??no(r.parser,t,i,e),l=ar({...ir(),...u});if(!a)return null;const p=f?W(oo,{base:f},rn(o,l)):rn(o,l);return W(to.Provider,{value:l,children:p})},le=Ot((t,e)=>{const n=Me(),[o,r]=St(n),{to:i="",href:a=i,onClick:u,asChild:f,children:l,className:p,replace:c,state:m,...E}=t,S=Yn(w=>{w.ctrlKey||w.metaKey||w.altKey||w.shiftKey||w.button!==0||(u==null||u(w),w.defaultPrevented||(w.preventDefault(),r(a,t)))}),T=n.hrefs(a[0]==="~"?a.slice(1):n.base+a,n);return f&&he(l)?xe(l,{onClick:S,href:T}):W("a",{...E,onClick:S,href:T,className:p!=null&&p.call?p(o===a):p,children:l,ref:e})}),ro=t=>Array.isArray(t)?t.flatMap(e=>ro(e&&e.type===$?e.props.children:e)):[t],cr=({children:t,location:e})=>{const n=Me(),[o]=St(n);for(const r of ro(t)){let i=0;if(he(r)&&(i=no(n.parser,r.props.path,e||o,r.props.nest))[0])return xe(r,{match:i})}return null},ee={COVER:"cover",TITLE:"title",SPELL:"spell",SPELLRIGHT:"spell-right"},sn={[ee.COVER]:"spellbook_cover.svg",[ee.TITLE]:"spellbook_title.svg",[ee.SPELL]:"spellbook_spell.svg",[ee.SPELLRIGHT]:"spellbook_spell_right.svg"};function ye({pageType:t,children:e}){return _("div",{className:"svg-overlay",children:[_("img",{className:"page-img",src:(o=>`assets/img/${sn[o]||sn[ee.COVER]}`)(t),alt:`${t} page of DnD book`}),e]})}const lr=(t,e)=>e.some(n=>t instanceof n);let an,cn;function ur(){return an||(an=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _r(){return cn||(cn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const so=new WeakMap,it=new WeakMap,io=new WeakMap,Xe=new WeakMap,It=new WeakMap;function fr(t){const e=new Promise((n,o)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{n(ue(t.result)),r()},a=()=>{o(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(n=>{n instanceof IDBCursor&&so.set(n,t)}).catch(()=>{}),It.set(e,t),e}function dr(t){if(it.has(t))return;const e=new Promise((n,o)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{n(),r()},a=()=>{o(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});it.set(t,e)}let at={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return it.get(t);if(e==="objectStoreNames")return t.objectStoreNames||io.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ue(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hr(t){at=t(at)}function pr(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const o=t.call(Ze(this),e,...n);return io.set(o,e.sort?e.sort():[e]),ue(o)}:_r().includes(t)?function(...e){return t.apply(Ze(this),e),ue(so.get(this))}:function(...e){return ue(t.apply(Ze(this),e))}}function mr(t){return typeof t=="function"?pr(t):(t instanceof IDBTransaction&&dr(t),lr(t,ur())?new Proxy(t,at):t)}function ue(t){if(t instanceof IDBRequest)return fr(t);if(Xe.has(t))return Xe.get(t);const e=mr(t);return e!==t&&(Xe.set(t,e),It.set(e,t)),e}const Ze=t=>It.get(t);function Er(t,e,{blocked:n,upgrade:o,blocking:r,terminated:i}={}){const a=indexedDB.open(t,e),u=ue(a);return o&&a.addEventListener("upgradeneeded",f=>{o(ue(a.result),f.oldVersion,f.newVersion,ue(a.transaction),f)}),n&&a.addEventListener("blocked",f=>n(f.oldVersion,f.newVersion,f)),u.then(f=>{i&&f.addEventListener("close",()=>i()),r&&f.addEventListener("versionchange",l=>r(l.oldVersion,l.newVersion,l))}).catch(()=>{}),u}const gr=["get","getKey","getAll","getAllKeys","count"],yr=["put","add","delete","clear"],Qe=new Map;function ln(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Qe.get(e))return Qe.get(e);const n=e.replace(/FromIndex$/,""),o=e!==n,r=yr.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!(r||gr.includes(n)))return;const i=async function(a,...u){const f=this.transaction(a,r?"readwrite":"readonly");let l=f.store;return o&&(l=l.index(u.shift())),(await Promise.all([l[n](...u),r&&f.done]))[0]};return Qe.set(e,i),i}hr(t=>({...t,get:(e,n,o)=>ln(e,n)||t.get(e,n,o),has:(e,n)=>!!ln(e,n)||t.has(e,n)}));const L={RECENTPAGE:"recentPage",FONTADDITION:"fontAddition",PAGEFIT:"pageFit",ANIMATION:"animation",CURRENT_SPELLBOOK_DB:"currentSpellbookDb",SPELLBOOK_LIST:"spellbookList",CUSTOM_FONT:"customFont",CUSTOM_FONT_NAME:"customFontName"},Oe={[L.RECENTPAGE]:1,[L.FONTADDITION]:0,[L.PAGEFIT]:!1,[L.ANIMATION]:!0,[L.CURRENT_SPELLBOOK_DB]:"Spellbook",[L.SPELLBOOK_LIST]:["Spellbook"],[L.CUSTOM_FONT]:null,[L.CUSTOM_FONT_NAME]:null},s={PAGE:"page",NAME:"name",INCANT:"incant",SPEED:"speed",RANGE:"range",TYPE:"type",DESC:"desc",LVL:"lvl",ICONURL:"iconUrl",ICONOBJECTFIT:"iconObjectFit",ICONOBJECTURL:"iconObjectUrl"},ct={[s.PAGE]:0,[s.NAME]:"",[s.INCANT]:"",[s.SPEED]:"",[s.RANGE]:"",[s.TYPE]:"",[s.DESC]:"",[s.LVL]:0,[s.ICONURL]:"",[s.ICONOBJECTFIT]:"contain"},B={PAGE:"page",TITLE:"title",TYPE:"type",CONTENT:"content",ICONURL:"iconUrl",ICONOBJECTFIT:"iconObjectFit",DATE:"date"},vr={[B.PAGE]:0,[B.TITLE]:"",[B.TYPE]:"text",[B.CONTENT]:"",[B.ICONURL]:"",[B.ICONOBJECTFIT]:"contain",[B.DATE]:new Date().toISOString()};class ao{static async initDB(e,n,o){return Er(e,n,{upgrade(r,i,a,u){o&&o(r,i,a,u)}})}}class z{static async init(){return this.db?this.db:(this.db=await ao.initDB(this.DB_NAME,this.VERSION,e=>{e.objectStoreNames.contains(this.STORE_NAME)||e.createObjectStore(this.STORE_NAME,{keyPath:"key"})}),await this.initializeDefaultSettings(),this.db)}static async initializeDefaultSettings(){const e=await this.getAll();for(const[n,o]of Object.entries(Oe))e[n]===void 0&&await this.set(n,o)}static validateSettingKey(e){const n=Object.values(L);if(!n.includes(e))throw new Error(`Invalid setting key: ${e}. Valid keys are: ${n.join(", ")}`);return!0}static async get(e){this.validateSettingKey(e),await this.init();const n=await this.db.get(this.STORE_NAME,e);return n?n.value:Oe[e]!==void 0?Oe[e]:null}static async set(e,n){return this.validateSettingKey(e),await this.init(),this.db.put(this.STORE_NAME,{key:e,value:n})}static async delete(e){return this.validateSettingKey(e),await this.init(),this.db.delete(this.STORE_NAME,e)}static async getAll(){await this.init();const e={},n=Object.values(L);for(const r of n)e[r]=Oe[r];const o=await this.db.getAll(this.STORE_NAME);for(const r of o)n.includes(r.key)&&(e[r.key]=r.value);return e}static async resetToDefaults(){await this.init();const e=Object.values(L);for(const n of e)await this.delete(n).catch(()=>{});for(const[n,o]of Object.entries(Oe))await this.set(n,o)}static async clear(){await this.init();const e=Object.values(L);for(const n of e)await this.delete(n).catch(()=>{})}}Q(z,"DB_NAME","Spellbook_Settings"),Q(z,"STORE_NAME","settings"),Q(z,"VERSION",2),Q(z,"db",null);class U{static async init(e=null){return e||(e=await z.get(L.CURRENT_SPELLBOOK_DB)),this.activeDB&&this.activeDBName===e?this.activeDB:(this.activeDB&&(this.activeDB.close(),this.activeDB=null,this.activeDBName=null),this.activeDB=await ao.initDB(e,this.VERSION,n=>{if(n.objectStoreNames.contains(this.SPELLS_STORE)||n.createObjectStore(this.SPELLS_STORE,{keyPath:s.PAGE}).createIndex("pageIndex",s.PAGE,{unique:!0}),!n.objectStoreNames.contains(this.NOTES_STORE)){const o=n.createObjectStore(this.NOTES_STORE,{keyPath:B.PAGE});o.createIndex("pageIndex",B.PAGE,{unique:!0}),o.createIndex("dateIndex",B.DATE,{unique:!1})}n.objectStoreNames.contains(this.SETTINGS_STORE)||n.createObjectStore(this.SETTINGS_STORE,{keyPath:"key"})}),this.activeDBName=e,this.activeDB)}static async switchSpellbook(e){await z.set(L.CURRENT_SPELLBOOK_DB,e),await this.init(e)}static async renameSpellbook(e,n){const o=await this.exportSpellbookData();await this.createNewSpellbook(n),await this.importSpellbookData(o),await this.deleteSpellbook(e);const i=(await this.listAllSpellbooks()).map(a=>a===e?n:a);await z.set(L.SPELLBOOK_LIST,i),await this.switchSpellbook(n)}static async generateUniqueSpellbookName(e){const n=await this.listAllSpellbooks();let o=e,r=1;for(;n.includes(o);)o=`${e} (${r})`,r++;return o}static async getCurrentSpellbookName(){return z.get(L.CURRENT_SPELLBOOK_DB)}static async listAllSpellbooks(){return await z.get("spellbookList")||[await this.getCurrentSpellbookName()]}static async createNewSpellbook(e){const n=await this.listAllSpellbooks();n.includes(e)||(n.push(e),await z.set("spellbookList",n)),await this.switchSpellbook(e)}static async deleteSpellbook(e){const n=await this.getCurrentSpellbookName();if(e===n)throw new Error("Cannot delete the currently active spellbook");const r=(await this.listAllSpellbooks()).filter(i=>i!==e);await z.set("spellbookList",r),await window.indexedDB.deleteDatabase(e)}static validateSpell(e){const n=Object.values(s),o=["_iconObjectUrl"],r=[s.ICONURL,s.ICONOBJECTURL,s.ICONOBJECTFIT];for(const i of n)if(!r.includes(i)&&e[i]===void 0)throw new Error(`Missing required spell property: ${i}`);for(const i in e)if(!n.includes(i)&&!o.includes(i))throw new Error(`Invalid spell property: ${i}`);return!0}static createEmptySpell(e){return{...ct,[s.PAGE]:e}}static async getSpellByPage(e){const o=await(await this.init()).get(this.SPELLS_STORE,e);return o?(o[s.ICONURL]instanceof Blob&&(o._iconObjectUrl=URL.createObjectURL(o[s.ICONURL])),o):null}static async saveSpell(e){const n=await this.init(),o={...e};return"_iconObjectUrl"in o&&delete o._iconObjectUrl,this.validateSpell(o),await n.put(this.SPELLS_STORE,o),o[s.PAGE]}static async deleteSpellByPage(e){const n=await this.init();let o=await this.getAllSpells();await n.delete(this.SPELLS_STORE,e);const r=o.filter(i=>i[s.PAGE]>e);for(const i of r){const a={...i};a[s.PAGE]=i[s.PAGE]-1,await n.delete(this.SPELLS_STORE,i[s.PAGE]),await this.saveSpell(a)}}static async getAllSpells(){return(await(await this.init()).getAll(this.SPELLS_STORE)).map(o=>(o[s.ICONURL]instanceof Blob&&(o._iconObjectUrl=URL.createObjectURL(o[s.ICONURL])),o))}static async getAllSpellsSortedByPage(){return(await this.getAllSpells()).sort((n,o)=>n[s.PAGE]-o[s.PAGE])}static async getHighestSpellPageNumber(){const e=await this.getAllSpells();return e.length===0?0:Math.max(...e.map(n=>n[s.PAGE]))}static async swapSpellPages(e,n){try{const o=await this.getSpellByPage(e),r=await this.getSpellByPage(n);if(!o||!r)return!1;const i=o[s.PAGE];return o[s.PAGE]=r[s.PAGE],r[s.PAGE]=i,await this.saveSpell(o),await this.saveSpell(r),!0}catch(o){return console.error("Error swapping spell pages:",o),!1}}static validateNote(e){const n=Object.values(B);for(const o of n)if(e[o]===void 0)throw new Error(`Missing required note property: ${o}`);for(const o in e)if(!n.includes(o))throw new Error(`Invalid note property: ${o}`);return!0}static createEmptyNote(e){return{...vr,[B.PAGE]:e,[B.DATE]:new Date().toISOString()}}static async getNoteByPage(e){return await(await this.init()).get(this.NOTES_STORE,e)||null}static async saveNote(e){const n=await this.init();return e[B.DATE]=new Date().toISOString(),this.validateNote(e),await n.put(this.NOTES_STORE,e),e[B.PAGE]}static async deleteNoteByPage(e){return(await this.init()).delete(this.NOTES_STORE,e)}static async getAllNotes(){return(await this.init()).getAll(this.NOTES_STORE)}static async getAllNotesSortedByPage(){return(await this.getAllNotes()).sort((n,o)=>n[B.PAGE]-o[B.PAGE])}static async getAllNotesSortedByDate(){return(await this.getAllNotes()).sort((n,o)=>new Date(o[B.DATE])-new Date(n[B.DATE]))}static async getHighestNotePageNumber(){const e=await this.getAllNotes();return e.length===0?0:Math.max(...e.map(n=>n[B.PAGE]))}static async clearAllContent(){const e=await this.init();await e.clear(this.SPELLS_STORE),await e.clear(this.NOTES_STORE)}static async importSpellbookData(e){const n=await this.init();e.font&&await this.saveFont(e.font);const o=n.transaction([this.SPELLS_STORE,this.NOTES_STORE],"readwrite");if(e.spells&&Array.isArray(e.spells))for(const r of e.spells)try{const{_iconObjectUrl:i,...a}=r;if(a[s.ICONURL]&&a[s.ICONURL].data){const f=a[s.ICONURL].data.split(",")[1],l=atob(f),p=[];for(let c=0;c<l.length;c+=512){const m=l.slice(c,c+512),E=new Array(m.length);for(let T=0;T<m.length;T++)E[T]=m.charCodeAt(T);const S=new Uint8Array(E);p.push(S)}a[s.ICONURL]=new File(p,a[s.ICONURL].name||"image.png",{type:a[s.ICONURL].type||"image/png"})}this.validateSpell(a),await o.objectStore(this.SPELLS_STORE).put(a)}catch(i){console.error("Error importing spell:",i)}if(e.notes&&Array.isArray(e.notes))for(const r of e.notes)try{this.validateNote(r),await o.objectStore(this.NOTES_STORE).put(r)}catch(i){console.error("Error importing note:",i)}await o.done}static async exportSpellbookData(){const e=await this.getFont(),n=await this.getAllSpells(),o=await Promise.all(n.map(async r=>{const i={...r};return i[s.ICONURL]instanceof Blob&&(i[s.ICONURL]={data:await this.fileToBase64(i[s.ICONURL]),type:i[s.ICONURL].type,name:i[s.ICONURL].name}),delete i._iconObjectUrl,i}));return e&&e.data instanceof Blob&&(e.data=await this.fileToBase64(e.data)),{spells:o,notes:await this.getAllNotes(),name:this.activeDBName,exportDate:new Date().toISOString(),font:e}}static async saveFont(e){await(await this.init()).put(this.SETTINGS_STORE,{key:"font",data:e.data,name:e.name})}static async getFont(){const e=await this.init();return e.objectStoreNames.contains(this.SETTINGS_STORE)?await e.get(this.SETTINGS_STORE,"font"):null}static async removeFont(){await(await this.init()).delete(this.SETTINGS_STORE,"font")}static async fileToBase64(e){return new Promise((n,o)=>{const r=new FileReader;r.readAsDataURL(e),r.onload=()=>n(r.result),r.onerror=i=>o(i)})}static async saveSpellImage(e,n){try{let o=await this.getSpellByPage(e);return o||(o=this.createEmptySpell(e)),o[s.ICONURL]=n,"_iconObjectUrl"in o&&delete o._iconObjectUrl,await this.saveSpell(o),URL.createObjectURL(n)}catch(o){throw console.error("Error saving spell image:",o),o}}}Q(U,"SPELLS_STORE","spells"),Q(U,"NOTES_STORE","notes"),Q(U,"VERSION",1),Q(U,"activeDB",null),Q(U,"activeDBName",null),Q(U,"SETTINGS_STORE","spellbookSettings");const co=Te(null);function br({children:t}){const[e,n]=C({}),[o,r]=C(!0),[i,a]=C(null),u=async()=>{try{const l=await U.getFont();if(l&&l.data){const E=new FontFace("SpellbookFont",`url(${l.data})`);await E.load(),document.fonts.add(E),document.body.style.fontFamily="SpellbookFont, MagicSchool, sans-serif"}else document.body.style.fontFamily="MagicSchool, sans-serif";const m=3+((await z.getAll())[L.FONTADDITION]||0)/10;document.documentElement.style.setProperty("--reactive-font-size",`${m}vh`)}catch(l){console.error("Error loading font:",l)}};F(()=>{(async()=>{try{r(!0);const p=await z.getAll();n(p),await u(),console.log("Settings loaded in context:",p)}catch(p){console.error("Error loading settings:",p),a(p.message)}finally{r(!1)}})()},[]);const f=async(l,p)=>{try{return await z.set(l,p),n(c=>({...c,[l]:p})),!0}catch(c){return console.error("Error updating setting:",c),a(c.message),!1}};return _(co.Provider,{value:{settings:e,loading:o,error:i,updateSetting:f,loadCustomFont:u},children:t})}const lt=()=>{const t=ve(co);if(t===null)throw new Error("useSettings must be used within a SettingsProvider");return t};function Nr({reorderMode:t=!1}){const[e,n]=C([]),[o,r]=C(null),[i,a]=C(!1);F(()=>{u()},[]),F(()=>{t||r(null)},[t]);const u=async()=>{try{const p=await U.getAllSpellsSortedByPage();n(p)}catch(p){console.error("Error loading spells:",p)}},f=async p=>{t&&(o===null?r(p):o[s.PAGE]===p[s.PAGE]?r(null):(a(!0),await U.swapSpellPages(o[s.PAGE],p[s.PAGE])&&await u(),r(null),a(!1)))},l=({spell:p,index:c})=>{const m=o&&o[s.PAGE]===p[s.PAGE],E=_($,{children:[_("img",{className:"small-icon",src:p&&(p._iconObjectUrl||p[s.ICONURL])?p._iconObjectUrl||p[s.ICONURL]:"assets/img/fireball.webp",alt:""}),_("div",{className:"spell-content",children:_("div",{className:"spellsOverview__spellname",children:[" ",p[s.NAME]]})}),_("div",{children:p[s.LVL]})]});return t?_("div",{className:`spell-item ${m?"selected":""} ${i?"disabled":""}`,onClick:()=>!i&&f(p),children:E},c):_(le,{to:`/spells?page=${p[s.PAGE]}`,className:"spell-item",children:E},c)};return _("div",{className:`spells-overview ${t?"reorder-mode":""}`,children:[t&&_("div",{className:"reorder-instructions",children:"Reorder"}),e.map((p,c)=>_(l,{spell:p,index:c},c)),_("div",{className:"spells-overview-after"})]})}function Or(){const[t,e]=C(!0),[n,o]=C(window.innerWidth>window.innerHeight),[r,i]=C(!1),{settings:a,loading:u}=lt();F(()=>{const l=()=>{o(window.innerWidth>window.innerHeight)};return window.addEventListener("resize",l),()=>window.removeEventListener("resize",l)},[]),F(()=>{let l=!1,p=!1;const c=setTimeout(()=>{l=!0,p&&e(!1)},500);return u||(p=!0,l&&e(!1)),()=>clearTimeout(c)},[a,u]);const f=()=>{i(l=>!l)};return _($,{children:t?_("div",{className:"svg-overlay",children:_("img",{className:"page-img",src:"assets/img/spellbook_cover.svg",alt:"Cover of DnD book"})}):_($,{children:[_(ye,{pageType:ee.TITLE,children:[_("div",{className:"text-overlay",id:"title",children:a[L.CURRENT_SPELLBOOK_DB]}),_(Nr,{reorderMode:r}),!n&&_(le,{to:"/spells",className:"interact next-page"}),_("button",{class:"interact home__edit-button",onClick:f}),_(le,{to:"/settings",class:"interact home__settings-button"})]}),n&&_(ye,{pageType:ee.SPELLRIGHT,children:n&&_(le,{to:"/spells",className:"interact next-page"})})]})})}function wr(){var be;const[t,e]=C(window.innerWidth>window.innerHeight),{settings:n,updateSetting:o}=lt(),[r,i]=C(""),[a,u]=C(n[L.CURRENT_SPELLBOOK_DB]),[f,l]=C(n[L.FONTADDITION]||0),[p,c]=C(n[L.SPELLBOOK_LIST]||[]),[m,E]=C(!1),S=async()=>{const v=await U.listAllSpellbooks();await o(L.SPELLBOOK_LIST,v);const A=await U.getCurrentSpellbookName();await o(L.CURRENT_SPELLBOOK_DB,A),E(!1)};F(()=>{S(),M()},[m]),F(()=>{u(n[L.CURRENT_SPELLBOOK_DB]),l(n[L.FONTADDITION]||0),c(n[L.SPELLBOOK_LIST]||[])},[n]),F(()=>{const v=()=>{e(window.innerWidth>window.innerHeight)};return window.addEventListener("resize",v),()=>window.removeEventListener("resize",v)},[]);const T=async()=>{try{const v=await U.exportSpellbookData(),A=new Blob([JSON.stringify(v)],{type:"application/json"}),q=URL.createObjectURL(A),V=document.createElement("a");V.href=q,V.download=`${n[L.CURRENT_SPELLBOOK_DB]}.json.spellbook`,document.body.appendChild(V),V.click(),document.body.removeChild(V),URL.revokeObjectURL(q)}catch(v){console.error("Export failed:",v)}},[w,I]=C(null),[R,G]=C(null),x=async v=>{try{const A=v.target.files[0];if(!A)return;G(A);const q=new FileReader;q.onload=async V=>{const Z=JSON.parse(V.target.result);I(Z)},q.readAsText(A)}catch(A){console.error("Import failed:",A),I(null),G(null)}},ne=async()=>{try{if(!w)return;const v=await U.generateUniqueSpellbookName(w.name||"Imported Spellbook");await U.createNewSpellbook(v),await U.importSpellbookData(w),I(null),G(null),E(!0)}catch(v){console.error("Import failed:",v)}},ce=async()=>{try{const v=n[L.CURRENT_SPELLBOOK_DB];v!==a&&(await U.renameSpellbook(v,a),E(!0))}catch(v){console.error("Failed to change spellbook name:",v)}},[Ue,J]=C(null);F(()=>{(async()=>{const A=await U.getFont();J(A)})()},[]);const{loadCustomFont:M}=lt(),X=async v=>{const A=v.target.files[0];if(A)try{const q=new FileReader;q.onload=async V=>{const Z={data:V.target.result,name:A.name};await U.saveFont(Z),J(Z),await M()},q.readAsDataURL(A)}catch(q){console.error("Failed to upload font:",q)}},j=async()=>{try{await U.removeFont(),J(null),await M()}catch(v){console.error("Failed to remove font:",v)}},Y=async()=>{if(r)try{await U.createNewSpellbook(r),await o(L.CURRENT_SPELLBOOK_DB,r),i(""),E(!0)}catch(v){console.error("Failed to create new spellbook:",v)}},ke=async v=>{const A=parseInt(v)||0;l(A),await o(L.FONTADDITION,A),await M()},Ge=async v=>{await o(L.ANIMATION,v)},Ve=async v=>{await o(L.PAGEFIT,v)},He=async v=>{if(window.confirm(`Are you sure you want to delete the spellbook "${v}"?`))try{await U.deleteSpellbook(v),E(!0)}catch(A){console.error("Failed to delete spellbook:",A)}};return _($,{children:[_(ye,{pageType:ee.TITLE,children:[_("div",{className:"text-overlay",id:"title",children:"Settings"}),_("div",{className:"settings__container",children:[_("div",{children:["Spellbook Settings",_("hr",{className:"settings__hr-break"})]}),_("div",{className:"settings__container-line",children:[_("label",{className:"settings__file-input-label",for:"spellbookName",children:["Name:",_("br",{}),_("input",{type:"text",value:a,id:"spellbookName",onChange:v=>u(v.target.value),className:"settings__input"})]}),_("button",{className:"settings__interact",onClick:ce,children:"Change"})]}),_("div",{className:"settings__container-line",children:[_("label",{className:"settings__file-input-label",children:["Spellbook Font",_("input",{type:"file",accept:".ttf,.otf,.woff,.woff2",onChange:X,className:"settings__file-input"})]}),_("button",{className:"settings__interact",onClick:j,children:"X"})]}),_("div",{children:["Change Spellbook",_("div",{children:[_("div",{children:["Current: ",_("i",{children:n[L.CURRENT_SPELLBOOK_DB]})]}),(be=n[L.SPELLBOOK_LIST])==null?void 0:be.filter(v=>v!==n[L.CURRENT_SPELLBOOK_DB]).map(v=>_("div",{className:"settings__spellbook-item",children:[_("button",{onClick:async()=>{await U.switchSpellbook(v),E(!0)},className:"settings__spellbook-button",children:v}),_("button",{className:"settings__interact",onClick:()=>He(v),children:"Delete"})]},v))]})]}),_("div",{className:"settings__container-line",children:[_("label",{for:"newSpellbookName",children:["Create new spellbook",_("input",{type:"text",id:"newSpellbookName",value:r,className:"settings__input",onChange:v=>i(v.target.value)})]}),_("button",{className:"settings__interact",onClick:Y,children:"Add"})]}),_("div",{children:[_("label",{for:"exportSpellbook",children:"Export Spellbook"}),_("br",{}),_("button",{id:"exportSpellbook",className:"settings__interact",onClick:T,children:"Export"})]}),_("div",{children:[_("label",{for:"importSpellbook",children:"Import Spellbook"}),_("input",{type:"file",accept:".spellbook,.json",id:"importSpellbook",onChange:x,className:"settings__file-input"}),w&&_("div",{children:[_("p",{children:['Import "',w.name||"Unnamed Spellbook",'"?']}),_("button",{onClick:ne,children:"Confirm Import"}),_("button",{onClick:()=>{I(null),G(null)},children:"Cancel"})]})]}),_("div",{children:["General Settings",_("hr",{className:"settings__hr-break"})]}),_("label",{children:["Fontsize:",_("input",{type:"number",value:f,onChange:v=>ke(v.target.value),className:"settings__input"})]}),_("label",{children:["Animations:",_("input",{type:"checkbox",checked:n[L.ANIMATION],onChange:v=>Ge(v.target.checked)})]}),_("label",{children:["Page Fit:",_("input",{type:"checkbox",checked:n[L.PAGEFIT],onChange:v=>Ve(v.target.checked)})]}),_("div",{className:"settings__container-after"})]}),_(le,{to:"/",className:"interact settings__home-button"}),_("button",{className:"interact settings__font-button"}),_("button",{className:"interact settings__edit-button"})]}),t&&_(ye,{pageType:ee.SPELLRIGHT})]})}const Cr=(t,e)=>{const[n,o]=C(null);return $e((...i)=>{n&&clearTimeout(n),o(setTimeout(()=>{t(...i),o(null)},e))},[t,e,n])},Lr=({type:t,id:e,isDoublePage:n,onAnimationEnd:o})=>{const r=re(null);F(()=>{const a=r.current;if(a){a.play().catch(f=>console.error("Failed to play animation:",f));const u=()=>{o&&o(e)};return a.addEventListener("ended",u),()=>a.removeEventListener("ended",u)}},[e,o]);const i=t==="next"?n?"assets/ani/next-page-double.webm":"assets/ani/next-page.webm":n?"assets/ani/previous-page-double.webm":"assets/ani/previous-page.webm";return _("video",{ref:r,className:`page-transition-animation ${t}-animation`,muted:!0,playsInline:!0,children:_("source",{src:i,type:"video/webm"})})};function Sr(){const[t,e]=C(window.innerWidth>window.innerHeight),[n,o]=C([]),[r,i]=C(null),[a,u]=C(null),[f,l]=C(0),[p,c]=C(!0),[m,E]=C(!1),S=re(null),T=re(null),[w,I]=C(!1),[R,G]=C(!1),[x,ne]=C(null),[ce,Ue]=C(null),[J,M]=C({[s.NAME]:"",[s.INCANT]:"",[s.SPEED]:"",[s.RANGE]:"",[s.TYPE]:"",[s.DESC]:"",[s.LVL]:0,[s.ICONURL]:"",[s.ICONOBJECTFIT]:"contain"}),[X,j]=C({[s.NAME]:"",[s.INCANT]:"",[s.SPEED]:"",[s.RANGE]:"",[s.TYPE]:"",[s.DESC]:"",[s.LVL]:0,[s.ICONURL]:"",[s.ICONOBJECTFIT]:"contain"}),[Y,ke]=C([]),[Ge,Ve]=C(0);F(()=>{const g=()=>{const H=new URLSearchParams(window.location.search).get("page");return H?parseInt(H,10):0},y=g();l(y);const h=()=>{const N=g();l(N)};return window.addEventListener("popstate",h),()=>window.removeEventListener("popstate",h)},[]),F(()=>{(async()=>{try{const y=await U.getAllSpells();o(y),c(!1)}catch(y){console.error("Error loading spells:",y),c(!1)}})()},[]),F(()=>{if(n.length===0)return;const g=async(y=!1)=>{const h=n.find(P=>P[s.PAGE]===f+(y?1:0)),N=y?j:M,H=y?u:i;let d=h;if(h&&h[s.ICONURL]&&typeof h[s.ICONURL]!="string"&&!h._iconObjectUrl){const P=URL.createObjectURL(h[s.ICONURL]);se.current.add(P),d={...h,_iconObjectUrl:P},o(Ne=>Ne.map(K=>K[s.PAGE]===h[s.PAGE]?d:K))}H(d||null);const b=(d==null?void 0:d._iconObjectUrl)||(d==null?void 0:d[s.ICONURL])||"";N({[s.NAME]:(d==null?void 0:d[s.NAME])||"",[s.INCANT]:(d==null?void 0:d[s.INCANT])||"",[s.SPEED]:(d==null?void 0:d[s.SPEED])||"",[s.RANGE]:(d==null?void 0:d[s.RANGE])||"",[s.TYPE]:(d==null?void 0:d[s.TYPE])||"",[s.DESC]:(d==null?void 0:d[s.DESC])||"",[s.LVL]:(d==null?void 0:d[s.LVL])||0,[s.ICONURL]:b,[s.ICONOBJECTFIT]:(d==null?void 0:d[s.ICONOBJECTFIT])||"contain"})};x&&Y.length>0?x==="next"?g(!0):x==="previous"&&g(!1):(g(!1),g(!0))},[n,f,x,Y.length]);const He=async(g,y=!1)=>{try{const h=y?f+1:f,N=y?a:r,H={...g};"_iconObjectUrl"in H&&delete H._iconObjectUrl;let d;if(N){const{_iconObjectUrl:P,...Ne}=N;d={...Ne,...H}}else d={...ct,[s.PAGE]:h,...H};await U.saveSpell(d),N&&N._iconObjectUrl&&(d._iconObjectUrl=N._iconObjectUrl),o(P=>P.some(K=>K[s.PAGE]===h)?P.map(K=>K[s.PAGE]===h?(K._iconObjectUrl&&!d._iconObjectUrl?d._iconObjectUrl=K._iconObjectUrl:d[s.ICONURL]&&typeof d[s.ICONURL]!="string"&&!d._iconObjectUrl&&(d._iconObjectUrl=URL.createObjectURL(d[s.ICONURL]),se.current.add(d._iconObjectUrl)),d):K):(d[s.ICONURL]&&typeof d[s.ICONURL]!="string"&&!d._iconObjectUrl&&(d._iconObjectUrl=URL.createObjectURL(d[s.ICONURL]),se.current.add(d._iconObjectUrl)),[...P,d]));const b={...d};b[s.ICONURL]&&typeof b[s.ICONURL]!="string"&&!b._iconObjectUrl&&(b._iconObjectUrl=URL.createObjectURL(b[s.ICONURL]),se.current.add(b._iconObjectUrl)),y?(u(b),j(P=>({...P,[s.ICONURL]:b._iconObjectUrl||b[s.ICONURL]||P[s.ICONURL]}))):(i(b),M(P=>({...P,[s.ICONURL]:b._iconObjectUrl||b[s.ICONURL]||P[s.ICONURL]})))}catch(h){console.error("Error saving spell:",h)}},be=Cr((g,y=!1)=>{He(g,y)},800),v=(g,y)=>{g===s.LVL&&(y=parseInt(y,10)||0),M(N=>({...N,[g]:y}));const h={...J,[g]:y};g!==s.ICONURL&&r&&r[s.ICONURL]&&(h[s.ICONURL]=r[s.ICONURL]),be(h)},A=(g,y)=>{g===s.LVL&&(y=parseInt(y,10)||0),j(N=>({...N,[g]:y}));const h={...X,[g]:y,[s.PAGE]:f+1};g!==s.ICONURL&&a&&a[s.ICONURL]&&(h[s.ICONURL]=a[s.ICONURL]),be(h,!0)},q=()=>{E(!m)};F(()=>{const g=()=>{e(window.innerWidth>window.innerHeight)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]);const V=(g,y,h)=>m?_("input",{type:g===s.LVL?"number":"text",className:`${y} editable`,value:J[g],onInput:N=>v(g,N.target.value),placeholder:h}):_("div",{className:y,children:r?r[g]:""}),Z=(g,y,h)=>m?_("input",{type:g===s.LVL?"number":"text",className:`${y} editable`,value:X[g],onInput:N=>A(g,N.target.value),placeholder:h}):_("div",{className:y,children:a?a[g]:""}),Tt=async(g,y=!1)=>{const h=g.target.files[0];if(h)try{y?G(!0):I(!0);const N=y?f+1:f,H=await U.saveSpellImage(N,h);se.current.add(H);const d={...y?a||{}:r||{},[s.PAGE]:N,[s.ICONURL]:h,_iconObjectUrl:H},b={...y?X:J,[s.ICONURL]:H};y?(j(b),u(d)):(M(b),i(d)),o(P=>{if(P.some(K=>K[s.PAGE]===N))return P.map(K=>K[s.PAGE]===N?d:K);{const K={...ct,[s.PAGE]:N,[s.ICONURL]:h,_iconObjectUrl:H};return[...P,K]}})}catch(N){console.error("Error uploading image:",N)}finally{y?G(!1):I(!1)}},se=re(new Set);F(()=>()=>{se.current.forEach(g=>{URL.revokeObjectURL(g)}),se.current.clear()},[]);const Ae=(g=!1)=>{var y,h;g?(y=T.current)==null||y.click():(h=S.current)==null||h.click()},Ke=g=>{const y=Math.max(0,g),h=new URL(window.location);h.searchParams.set("page",y),window.history.pushState({},"",h),l(y)},Rt=g=>{const y=Ge;Ve(h=>h+1),ke(h=>[...h,{id:y,type:g}])},lo=g=>{if(ke(y=>y.filter(h=>h.id!==g)),Y.length===1){if(x==="next"){const y=n.find(N=>N[s.PAGE]===f);let h=y;if(y&&y[s.ICONURL]&&typeof y[s.ICONURL]!="string"&&!y._iconObjectUrl){const N=URL.createObjectURL(y[s.ICONURL]);se.current.add(N),h={...y,_iconObjectUrl:N}}i(h||null),M({[s.NAME]:(h==null?void 0:h[s.NAME])||"",[s.INCANT]:(h==null?void 0:h[s.INCANT])||"",[s.SPEED]:(h==null?void 0:h[s.SPEED])||"",[s.RANGE]:(h==null?void 0:h[s.RANGE])||"",[s.TYPE]:(h==null?void 0:h[s.TYPE])||"",[s.DESC]:(h==null?void 0:h[s.DESC])||"",[s.LVL]:(h==null?void 0:h[s.LVL])||0,[s.ICONURL]:(h==null?void 0:h._iconObjectUrl)||(h==null?void 0:h[s.ICONURL])||"",[s.ICONOBJECTFIT]:(h==null?void 0:h[s.ICONOBJECTFIT])||"contain"})}else if(x==="previous"){const y=n.find(N=>N[s.PAGE]===f+1);let h=y;if(y&&y[s.ICONURL]&&typeof y[s.ICONURL]!="string"&&!y._iconObjectUrl){const N=URL.createObjectURL(y[s.ICONURL]);se.current.add(N),h={...y,_iconObjectUrl:N}}u(h||null),j({[s.NAME]:(h==null?void 0:h[s.NAME])||"",[s.INCANT]:(h==null?void 0:h[s.INCANT])||"",[s.SPEED]:(h==null?void 0:h[s.SPEED])||"",[s.RANGE]:(h==null?void 0:h[s.RANGE])||"",[s.TYPE]:(h==null?void 0:h[s.TYPE])||"",[s.DESC]:(h==null?void 0:h[s.DESC])||"",[s.LVL]:(h==null?void 0:h[s.LVL])||0,[s.ICONURL]:(h==null?void 0:h._iconObjectUrl)||(h==null?void 0:h[s.ICONURL])||"",[s.ICONOBJECTFIT]:(h==null?void 0:h[s.ICONOBJECTFIT])||"contain"})}ne(null)}},Ut=()=>{ne("next"),Rt("next"),Ke(f+(t?2:1))},uo=()=>{f!==0&&(ne("previous"),Rt("previous"),Ke(Math.max(f-(t?2:1),0)))},kt=async(g=!1)=>{var y;try{const h=g?f+1:f;if(!confirm(`Are you sure you want to delete the spell: ${(y=g?a:r)==null?void 0:y[s.NAME]}?`))return;await U.deleteSpellByPage(h);const N=await U.getAllSpells();o(N);const H=N.length>0?Math.max(...N.map(d=>d[s.PAGE])):-1;if(g){const d=N.find(b=>b[s.PAGE]===f+1);u(d||null),j({[s.NAME]:(d==null?void 0:d[s.NAME])||"",[s.INCANT]:(d==null?void 0:d[s.INCANT])||"",[s.SPEED]:(d==null?void 0:d[s.SPEED])||"",[s.RANGE]:(d==null?void 0:d[s.RANGE])||"",[s.TYPE]:(d==null?void 0:d[s.TYPE])||"",[s.DESC]:(d==null?void 0:d[s.DESC])||"",[s.LVL]:(d==null?void 0:d[s.LVL])||0,[s.ICONURL]:(d==null?void 0:d._iconObjectUrl)||(d==null?void 0:d[s.ICONURL])||"",[s.ICONOBJECTFIT]:(d==null?void 0:d[s.ICONOBJECTFIT])||"contain"})}else if(f>H&&f>0)Ke(t?Math.max(f-2,0):f-1);else{const d=N.find(P=>P[s.PAGE]===f),b=N.find(P=>P[s.PAGE]===f+1);i(d||null),u(b||null),M({[s.NAME]:(d==null?void 0:d[s.NAME])||"",[s.INCANT]:(d==null?void 0:d[s.INCANT])||"",[s.SPEED]:(d==null?void 0:d[s.SPEED])||"",[s.RANGE]:(d==null?void 0:d[s.RANGE])||"",[s.TYPE]:(d==null?void 0:d[s.TYPE])||"",[s.DESC]:(d==null?void 0:d[s.DESC])||"",[s.LVL]:(d==null?void 0:d[s.LVL])||0,[s.ICONURL]:(d==null?void 0:d._iconObjectUrl)||(d==null?void 0:d[s.ICONURL])||"",[s.ICONOBJECTFIT]:(d==null?void 0:d[s.ICONOBJECTFIT])||"contain"}),j({[s.NAME]:(b==null?void 0:b[s.NAME])||"",[s.INCANT]:(b==null?void 0:b[s.INCANT])||"",[s.SPEED]:(b==null?void 0:b[s.SPEED])||"",[s.RANGE]:(b==null?void 0:b[s.RANGE])||"",[s.TYPE]:(b==null?void 0:b[s.TYPE])||"",[s.DESC]:(b==null?void 0:b[s.DESC])||"",[s.LVL]:(b==null?void 0:b[s.LVL])||0,[s.ICONURL]:(b==null?void 0:b._iconObjectUrl)||(b==null?void 0:b[s.ICONURL])||"",[s.ICONOBJECTFIT]:(b==null?void 0:b[s.ICONOBJECTFIT])||"contain"})}alert("Spell deleted successfully!")}catch(h){console.error("Error deleting spell:",h),alert("Error deleting spell. Please try again.")}};return _($,{children:[_(ye,{pageType:ee.SPELL,children:[V(s.NAME,"text-overlay spellname",""),V(s.INCANT,"text-overlay incant",""),V(s.SPEED,"text-overlay speed",""),V(s.RANGE,"text-overlay range",""),V(s.TYPE,"text-overlay type",""),m?_("textarea",{value:J[s.DESC],onInput:g=>v(s.DESC,g.target.value),className:"description textarea",placeholder:"Description"}):_("div",{className:"description",children:r?r[s.DESC]:""}),V(s.LVL,"level","0"),_("div",{className:"pageNumber",children:f+1}),_(le,{to:"/settings",className:"interact settings-button"}),_(le,{to:"/",className:"interact home-button"}),_("button",{className:"interact font-button"}),_("button",{className:"interact edit-button",onClick:q}),m&&_("button",{className:"interact delete-button",onClick:()=>kt(!1),children:"X"}),!m&&_("button",{className:"interact previous-page",onClick:uo}),!m&&!t&&_("button",{className:"interact next-page",onClick:Ut}),m?_($,{children:[_("input",{type:"file",ref:S,style:{display:"none"},accept:"image/*",onChange:g=>Tt(g)}),_("img",{className:"icon icon-editing interact",src:J[s.ICONURL]||"assets/img/fireball.webp",style:{objectFit:(r==null?void 0:r[s.ICONOBJECTFIT])||"contain"},alt:"",onClick:()=>Ae(),onKeyDown:g=>{g.key==="Enter"&&Ae()},tabIndex:0}),_("select",{className:"interact img-fit-select",name:"img-fit",id:"img-fit-select",value:(r==null?void 0:r[s.ICONOBJECTFIT])||"contain",onChange:g=>v(s.ICONOBJECTFIT,g.target.value),children:[_("option",{value:"contain",children:"Contain"}),_("option",{value:"cover",children:"Cover"}),_("option",{value:"fill",children:"Fill"}),_("option",{value:"none",children:"None"}),_("option",{value:"scale-down",children:"Scale Down"})]}),w&&_("div",{className:"loading-indicator",children:"Uploading..."})]}):_("img",{className:"icon",src:r&&(r._iconObjectUrl||r[s.ICONURL])?r._iconObjectUrl||r[s.ICONURL]:"assets/img/fireball.webp",style:r?{objectFit:r[s.ICONOBJECTFIT]}:{},alt:""})]}),t&&_(ye,{pageType:ee.SPELLRIGHT,children:[Z(s.NAME,"text-overlay spellname right-page-offset",""),Z(s.INCANT,"text-overlay incant right-page-offset",""),Z(s.SPEED,"text-overlay speed right-page-offset",""),Z(s.RANGE,"text-overlay range right-page-offset",""),Z(s.TYPE,"text-overlay type right-page-offset",""),m?_("textarea",{value:X[s.DESC],onInput:g=>A(s.DESC,g.target.value),className:"description textarea right-page-offset",placeholder:"Description"}):_("div",{className:"description right-page-offset",children:a?a[s.DESC]:""}),Z(s.LVL,"level right-page-offset","0"),_("div",{className:"pageNumber right-page-offset",children:f+2}),_("button",{className:"interact settings-button right-page-offset"}),_(le,{to:"/",className:"interact home-button right-page-offset"}),_("button",{className:"interact font-button right-page-offset"}),m&&_("button",{className:"interact delete-button right-page-offset",onClick:()=>kt(!0),children:"X"}),_("button",{className:"interact edit-button right-page-offset",onClick:q}),t&&!m&&_("button",{className:"interact next-page",onClick:Ut}),m?_($,{children:[_("input",{type:"file",ref:T,style:{display:"none"},accept:"image/*",onChange:g=>Tt(g,!0)}),_("img",{className:"icon icon-editing right-page-offset interact",src:X[s.ICONURL]||"assets/img/fireball.webp",style:{objectFit:(a==null?void 0:a[s.ICONOBJECTFIT])||"contain"},alt:"",onClick:()=>Ae(!0),onKeyDown:g=>{g.key==="Enter"&&Ae(!0)},tabIndex:0}),_("select",{className:"interact img-fit-select right-page-offset",name:"img-fit-next",id:"img-fit-select-next",value:(a==null?void 0:a[s.ICONOBJECTFIT])||"contain",onChange:g=>A(s.ICONOBJECTFIT,g.target.value),children:[_("option",{value:"contain",children:"Contain"}),_("option",{value:"cover",children:"Cover"}),_("option",{value:"fill",children:"Fill"}),_("option",{value:"none",children:"None"}),_("option",{value:"scale-down",children:"Scale Down"})]}),R&&_("div",{className:"loading-indicator right-page-offset",children:"Uploading..."})]}):_("img",{className:"icon right-page-offset",src:a&&(a._iconObjectUrl||a[s.ICONURL])?a._iconObjectUrl||a[s.ICONURL]:"assets/img/fireball.webp",style:a?{objectFit:a[s.ICONOBJECTFIT]}:{},alt:""})]}),Y.map(g=>_(Lr,{id:g.id,type:g.type,isDoublePage:t,onAnimationEnd:lo},g.id))]})}function Ir(){return F(()=>{(async()=>{try{const e=await U.getCurrentSpellbookName();console.log("Current spellbook:",e);const n=await U.getFont();if(n&&n.data){const o=new FontFace("SpellbookFont",`url(${n.data})`);await o.load(),document.fonts.add(o),document.body.style.fontFamily="SpellbookFont, MagicSchool, sans-serif"}}catch(e){console.error("Error loading data:",e)}})()},[]),_(br,{children:_("div",{className:"container",children:_(oo,{base:"/spellbook",children:_(cr,{children:[_(qe,{path:"/settings",component:wr}),_(qe,{path:"/spells",component:Sr}),_(qe,{path:"/",component:Or})]})})})})}const Tr="modulepreload",Rr=function(t){return"/spellbook/"+t},un={},Ur=function(e,n,o){let r=Promise.resolve();if(n&&n.length>0){let a=function(l){return Promise.all(l.map(p=>Promise.resolve(p).then(c=>({status:"fulfilled",value:c}),c=>({status:"rejected",reason:c}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=a(n.map(l=>{if(l=Rr(l),l in un)return;un[l]=!0;const p=l.endsWith(".css"),c=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":Tr,p||(m.as="script"),m.crossOrigin="",m.href=l,f&&m.setAttribute("nonce",f),document.head.appendChild(m),p)return new Promise((E,S)=>{m.addEventListener("load",E),m.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=a,window.dispatchEvent(u),!u.defaultPrevented)throw a}return r.then(a=>{for(const u of a||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})};function kr(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:r,onRegisteredSW:i,onRegisterError:a}=t;let u,f;const l=async(c=!0)=>{await f};async function p(){if("serviceWorker"in navigator){if(u=await Ur(async()=>{const{Workbox:c}=await import("./workbox-window.prod.es5-CwtvwXb3.js");return{Workbox:c}},[]).then(({Workbox:c})=>new c("/spellbook/sw.js",{scope:"/spellbook/",type:"classic"})).catch(c=>{a==null||a(c)}),!u)return;u.addEventListener("activated",c=>{(c.isUpdate||c.isExternal)&&window.location.reload()}),u.addEventListener("installed",c=>{c.isUpdate||o==null||o()}),u.register({immediate:e}).then(c=>{i?i("/spellbook/sw.js",c):r==null||r(c)}).catch(c=>{a==null||a(c)})}}return f=p(),l}kr();Ee(_(Ir,{}),document.getElementById("app"));
